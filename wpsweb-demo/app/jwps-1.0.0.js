!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).WPS={})}(this,function(e){"use strict";var t,n=function(){return(n=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};!function(e){e.unknown="unknown",e.spreadsheet="s",e.writer="w",e.presentation="p",e.pdf="f"}(t||(t={}));var o,r,i,p,a,s,c=(o=0,function(){return++o}),u=(r=null,function(e,t){if(!r){r=document.createElement("iframe");var n={id:"wps-iframe",src:e,scrolling:"no",frameborder:"0",allowfullscreen:"allowfullscreen",webkitallowfullscreen:"true",mozallowfullscreen:"true"};for(var o in n)r.setAttribute(o,n[o]);t?t.appendChild(r):document.body.appendChild(r)}return r}),d=function(e){u().contentWindow.postMessage(JSON.stringify(e),"*")},f=function(e){return new Promise(function(t){var n=c();e.type=m();var o=function(e){var r=JSON.parse(e.data);"wps.api.reply"===r.eventName&&r.msgId===n&&(t(r.data),window.removeEventListener("message",o,!1))};window.addEventListener("message",o,!1),d({eventName:"wps.jssdk.api",data:e,msgId:n})})},l=function(e){var t=n({},e),o=t.headers,r=void 0===o?{}:o,i=t.subscriptions,p=void 0===i?{}:i,a=(t.wpsUrl,r.backBtn),s=void 0===a?{}:a,c=r.shareBtn,u=void 0===c?{}:c,d=r.otherMenuBtn,f=void 0===d?{}:d,l=function(e,t){e.subscribe&&"function"==typeof e.subscribe&&(e.callback=t,p[t]=e.subscribe,delete e.subscribe)};if(l(s,"wpsconfig_back_btn"),l(u,"wpsconfig_share_btn"),l(f,"wpsconfig_other_menu_btn"),f.items&&Array.isArray(f.items)){var m=[];f.items.forEach(function(e,t){switch(void 0===e&&(e={}),e.type){case"export_img":e.type=1,e.callback="export_img";break;case"export_pdf":e.type=1,e.callback="export_pdf";break;case"save_version":e.type=1,e.callback="save_version";break;case"about_wps":e.type=1,e.callback="about_wps";break;case"split_line":e.type=2;break;case"custom":e.type=3,l(e,"wpsconfig_other_menu_btn_"+t),m.push(e)}}),m.length&&(v||x)&&(f.items=m)}if("object"==typeof p.print){var w="wpsconfig_print";"function"==typeof p.print.subscribe&&(p[w]=p.print.subscribe,t.print={callback:w},void 0!==p.print.custom&&(t.print.custom=p.print.custom)),delete p.print}"function"==typeof p.exportPdf&&(p[w="wpsconfig_export_pdf"]=p.exportPdf,t.exportPdf={callback:w},delete p.exportPdf);return n({},t,{subscriptions:p})},m=(i="",function(e){if(void 0===e&&(e=""),!i&&e){var n=e.toLowerCase();-1!==n.indexOf("/office/s/")&&(i=t.spreadsheet),-1!==n.indexOf("/office/w/")&&(i=t.writer),-1!==n.indexOf("/office/p/")&&(i=t.presentation),-1!==n.indexOf("/office/f/")&&(i=t.pdf)}return i}),w=window.navigator.userAgent.toLowerCase(),v=/Android|webOS|iPhone|iPod|BlackBerry|iPad/i.test(w),x=function(){try{return-1!==window._parent.location.search.indexOf("from=wxminiprogram")}catch(e){return!1}}();!function(e){e[e.wdExportFormatPDF=17]="wdExportFormatPDF",e[e.wdExportFormatXPS=18]="wdExportFormatXPS"}(p||(p={})),function(e){e[e.wdExportAllDocument=0]="wdExportAllDocument",e[e.wdExportSelection=1]="wdExportSelection",e[e.wdExportCurrentPage=2]="wdExportCurrentPage",e[e.wdExportFromTo=3]="wdExportFromTo"}(a||(a={})),function(e){e[e.wdExportDocumentContent=0]="wdExportDocumentContent",e[e.wdExportDocumentWithMarkup=7]="wdExportDocumentWithMarkup"}(s||(s={}));var y,b=function(e){e.WpsApplication=function(){return{ActiveDocument:{ExportAsFixedFormatAsync:function(e){var t={api:"WpsApplication().ActiveDocument.ExportAsFixedFormatAsync",args:n({ExportFormat:p.wdExportFormatPDF,Range:a.wdExportAllDocument,From:1,To:1,Item:s.wdExportDocumentWithMarkup,IncludeDocProps:!0},"object"==typeof e?e:{})};return f(t)}},Enum:n({},p,a,s)}}};!function(e){e[e.xlTypePDF=0]="xlTypePDF",e[e.xlTypeXPS=1]="xlTypeXPS"}(y||(y={}));var F,A,E,P=function(e){e.EtApplication=function(){return{ActiveWorkbook:{ExportAsFixedFormatAsync:function(e){var t={api:"EtApplication().ActiveWorkbook.ExportAsFixedFormatAsync",args:n({Type:y.xlTypePDF,IncludeDocProps:!0},"object"==typeof e?e:{})};return f(t)},ActiveSheet:{ExportAsFixedFormatAsync:function(e){var t={api:"EtApplication().ActiveWorkbook.ActiveSheet.ExportAsFixedFormatAsync",args:n({Type:y.xlTypePDF,IncludeDocProps:!0},"object"==typeof e?e:{})};return f(t)}}},Enum:n({},y)}}};!function(e){e[e.ppFixedFormatTypePDF=2]="ppFixedFormatTypePDF",e[e.ppFixedFormatTypeXPS=1]="ppFixedFormatTypeXPS"}(F||(F={})),function(e){e[e.ppPrintAll=1]="ppPrintAll",e[e.ppPrintCurrent=3]="ppPrintCurrent"}(A||(A={})),function(e){e[e.msoFalse=0]="msoFalse",e[e.msoTrue=-1]="msoTrue"}(E||(E={}));var g,k,h=function(e){e.WppApplication=function(){return{ActivePresentation:{ExportAsFixedFormatAsync:function(e){var t={api:"WppApplication().ActivePresentation.ExportAsFixedFormatAsync",args:n({FixedFormatType:F.ppFixedFormatTypePDF,RangeType:A.ppPrintAll,FrameSlides:E.msoTrue},"object"==typeof e?e:{})};return f(t)}},Enum:n({},F,A)}}},_=new Promise(function(e){return k=e}),D=function(e,t){void 0===e&&(e={});window.addEventListener("message",function(n){var o=JSON.parse(n.data),r=o.eventName,i=void 0===r?"":r,p=o.data,a=void 0===p?null:p,s=o.url,c=void 0===s?null:s;-1===["wps.jssdk.api"].indexOf(i)&&("ready"===i&&(d({eventName:"setConfig",data:e}),k()),"function"==typeof t[i]&&t[i](g,c||a))},!1)};e.config=function(e){void 0===e&&(e={});try{var o,r=l(e),i=r.wpsUrl,p=r.subscriptions,a=void 0===p?{}:p,s=r.mount,c=u(i,void 0===s?null:s),f=m(i);return delete r.wpsUrl,delete r.subscriptions,g={iframe:c,Enum:n({},E),setToken:function(e){_.then(function(){d({eventName:"setToken",data:e})})},ready:function(){return o||(o=new Promise(function(e){var n=function(o){"wps.advanced.api.ready"===JSON.parse(o.data).eventName&&(f===t.writer&&b(g),f===t.spreadsheet&&P(g),f===t.presentation&&h(g),e(),window.removeEventListener("message",n,!1))};window.addEventListener("message",n,!1)}))}},D(r,a),g.ready(),g}catch(e){console.error(e)}},Object.defineProperty(e,"__esModule",{value:!0})});
