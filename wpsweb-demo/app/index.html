<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <!-- 建议禁用外框浏览器自带的缩放 -->
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0,user-scalable=no" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  <title>WPS Web Office(iframe)接入指南</title>
  <style>
    * {
      box-sizing: border-box;
    }

    html,
    body {
      display: flex;
      flex-direction: column;
      padding: 0;
      margin: 0;
      height: 100%;
      /* 防止双击缩放 */
      touch-action: manipulation;
    }

    iframe {
      flex: 1;
    }

    ul {
      list-style:none;
    }

    li {
      padding: 20px;
    }

  </style>
  <script src="js/jwps-1.0.0.js"></script>
  <script type="text/javascript">
    // 支持 HTTPS
    // 注意：如果通过postMessage来设置token，请在url参数加上_w_hastoken=1
    window.onload = () => {

      async function render(files) {
        const list = document.querySelector("#list")
        const htmlStr  = []
        files.forEach(file => htmlStr.push(`<li><a href="/view.html?file=${encodeURIComponent(file)}">${file}</a></li>`))

        list.innerHTML= htmlStr.join('')
      }
      
      async function fetchList() {
        const res = await fetch('/getListFile') // getToken -> expires_in
        const data = await res.json()
        render(data.name_files)
      }

      fetchList()
    }
  </script>
</head>

<body>
<ul id="list"></ul>
</body>

</html>